<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tra Cứu Đơn Hàng</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="https://kit.fontawesome.com/your-kit-code.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">
    <style>
      :root {
        --primary-color: #CC232A; /* Fire Engine Red - màu chủ đạo */
        --secondary-color: #F5AC27; /* Bright Yellow - màu phụ */
        --accent-color: #FFD84B; /* Gargoyle Gas - màu nhấn */
        --light-accent: #F2888B; /* Tulip - màu nhẹ */
        --dark-primary: #A3262A; /* Auburn - màu đậm */
        --gold-color: #CC9902; /* Chinese Gold - màu vàng */
      }

      body {
        font-family: 'Roboto', sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f5f5f5;
      }

      /* Header styles */
      .header {
        display: flex;
        align-items: center;
        padding: 10px 40px;
        background-color: var(--primary-color);
        box-shadow: 0 2px 4px rgba(204, 35, 42, 0.2);
        position: fixed;
        width: 100%;
        height: 60px;
        top: 0;
        left: 0;
        z-index: 1000;
        box-sizing: border-box;
      }

      .header::after {
        content: '';
        position: absolute;
        bottom: -5px;
        left: 0;
        right: 0;
        height: 5px;
        background: linear-gradient(90deg, var(--gold-color), var(--accent-color), var(--gold-color));
      }

      .logo {
        height: 40px;
        width: auto;
      }

      .nav {
        margin-left: 30px;
        display: flex;
        gap: 20px;
        align-items: center;
      }

      .nav-item {
        position: relative;
        padding: 10px 15px;
        color: white;
        text-decoration: none;
        font-weight: 500;
        line-height: 40px;
        border-radius: 4px;
        transition: all 0.3s ease;
      }

      .nav-item:hover {
        background-color: var(--dark-primary);
      }

      .dropdown {
        position: relative;
        display: inline-block;
      }

      .dropdown-content {
        display: none;
        position: absolute;
        background-color: white;
        min-width: 200px;
        box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        z-index: 1;
        border-radius: 4px;
        top: 100%;
        left: 0;
        border-top: 3px solid var(--gold-color);
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
        padding-top: 5px;
      }

      .dropdown:hover .dropdown-content {
        display: block;
        opacity: 1;
        visibility: visible;
      }

      .dropdown-content a {
        color: #333;
        padding: 10px 15px;
        text-decoration: none;
        display: block;
        border-bottom: 1px solid #eee;
        line-height: 1.5;
      }

      .dropdown-content a:last-child {
        border-bottom: none;
      }

      .dropdown-content a:hover {
        background-color: var(--primary-color);
        color: white;
      }

      /* Thêm vào cuối phần style */
      .dropdown::after {
        content: '';
        position: absolute;
        height: 20px;
        width: 100%;
        bottom: -20px;
        left: 0;
      }

      .dropdown-content::before {
        content: '';
        position: absolute;
        height: 20px;
        width: 100%;
        top: -20px;
        left: 0;
      }

      /* Main content */
      .container {
        width: 95%;
        max-width: 1600px;
        margin: 80px auto 0;
        padding: 20px;
      }

      h1 {
        color: var(--primary-color);
        margin: 20px 0 30px;
        text-align: center;
        font-weight: 700;
        font-size: 32px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .search-container {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 30px;
        flex-wrap: wrap;
        justify-content: space-between;
        background-color: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      }

      .search-box {
        display: flex;
        gap: 10px;
        flex: 1;
        max-width: 600px;
        align-items: center;
      }

      .search-box input {
        flex: 1;
      }

      input[type="text"] {
        padding: 12px 15px;
        width: 100%;
        border: 2px solid #e1e5eb;
        border-radius: 8px;
        font-size: 15px;
        transition: all 0.3s;
      }

      button {
        padding: 12px 20px;
        background: linear-gradient(45deg, var(--primary-color), var(--dark-primary));
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 15px;
        cursor: pointer;
        transition: all 0.3s;
      }

      button:hover {
        background: linear-gradient(45deg, var(--dark-primary), var(--primary-color));
      }

      .viber-button {
        background-color: #665CAC;
        text-decoration: none;
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        font-size: 15px;
        transition: all 0.3s;
      }

      /* Table styles */
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        background-color: white;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        border-radius: 8px;
        overflow: hidden;
      }

      th {
        background-color: var(--primary-color);
        color: white;
        font-weight: 500;
        padding: 12px 15px;
        text-align: center !important;
        border: 1px solid #e1e5eb;
        white-space: nowrap;
        vertical-align: middle;
      }

      thead tr th {
        text-align: center !important;
        vertical-align: middle;
      }

      td {
        padding: 12px 15px;
        border: 1px solid #e1e5eb;
        font-size: 14px;
        line-height: 1.5;
        vertical-align: middle;
      }

      /* Định dạng cụ thể cho từng cột */
      table tr th, 
      table tr td {
        vertical-align: middle;
      }

      table tr td:nth-child(1) { /* Checker */
        width: 50px;
        text-align: center;
      }

      table tr td:nth-child(2) { /* Ngày đơn hàng */
        min-width: 100px;
        white-space: nowrap;
        text-align: center;
      }

      table tr td:nth-child(3) { /* Lịch giao hàng */
        min-width: 100px;
        white-space: nowrap;
        text-align: center;
      }

      table tr td:nth-child(4) { /* Trạng thái */
        text-align: center;
        width: 120px;
        max-width: 120px;
      }

      table tr td:nth-child(9) { /* Thanh toán */
        text-align: center;
      }

      table tr td:nth-child(10), 
      table tr td:nth-child(11) { /* Giá trị đơn và Phí giao hàng */
        text-align: center;
        min-width: 80px;
      }

      table tr td:nth-child(12) { /* Thời gian giao */
        text-align: center;
      }

      /* Định dạng cụ thể cho từng cột */
      table tr td:nth-child(5) { /* Mã đơn hàng */
        width: 160px;
        min-width: 160px;
        padding: 0 !important;
      }

      table tr td:nth-child(6) { /* Đơn đặt hàng */
        width: 160px;
        max-width: 160px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      table tr td:nth-child(7) { /* Khách hàng */
        min-width: 200px;
        max-width: none;
        white-space: normal;
        word-break: break-word;
      }

      table tr td:nth-child(8) { /* Địa chỉ giao */
        width: 250px;
        max-width: 250px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      /* Thêm tooltip khi hover vào các cột có ellipsis */
      td[title] {
        position: relative;
      }

      td[title]:hover::after {
        content: attr(title);
        position: absolute;
        left: 0;
        top: 100%;
        white-space: normal;
        background: #fff;
        padding: 5px 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        z-index: 1000;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        max-width: 300px;
      }

      /* Responsive */
      @media screen and (min-width: 1200px) {
        /* Trên màn hình lớn, cho phép text wrap */
        table tr td:nth-child(6),
        table tr td:nth-child(7),
        table tr td:nth-child(8) {
          white-space: normal;
          word-break: break-word;
        }
      }

      @media screen and (max-width: 1200px) {
        table {
          display: block;
          overflow-x: auto;
        }

        /* Đảm bảo các cột có độ rộng cố định */
        table th {
          white-space: nowrap;
        }
        
        /* Thêm title attribute cho các cột có ellipsis */
        table tr td:nth-child(6),
        table tr td:nth-child(7),
        table tr td:nth-child(8) {
          position: relative;
        }
      }

      /* Hover effect */
      tr:hover {
        background-color: rgba(245, 172, 39, 0.1);
      }

      /* Status tag styles */
      .status-tag {
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 13px;
        white-space: nowrap;
        display: inline-block;
      }

      /* Style cho các cột số */
      td.text-center {
        text-align: center;
      }

      /* Style cho các cột cần căn giữa */
      .amount-column, .shipping-column, .delivery-time-column {
          text-align: center;
      }

       /* Phí giao hàng */

      /* Style cho cột ghi chú */
      table tr td:nth-child(13) { /* Ghi chú */
        min-width: 80px;
        white-space: normal;
        word-break: break-word;
      }

      /* Style cho status badges */
      .status-finished, .status-waiting, .status-internal,
      .status-delivery, .status-wod, .status-cancelled,
      .status-confirmed, .status-new, .status-be-cancelled {
        padding: 6px 12px;
        border-radius: 30px;
        font-size: 12px;
        display: inline-block;
        text-align: center;
        min-width: 80px;
        font-weight: 500;
        color: white;
      }

      /* Màu cho từng trạng thái */
      .status-finished { background-color: #4CAF50; } /* Đã giao - Màu xanh lá */
      .status-waiting { background-color: var(--primary-color); } /* Tạm huỷ - Màu đỏ */
      .status-internal { background-color: #9C27B0; } /* Chuyển kho - Màu tím */
      .status-delivery { background-color: #2196F3; } /* Đang giao - Màu xanh dương */
      .status-wod { background-color: #9126f0; } /* Nhập kho giao - Màu tím nhạt */
      .status-cancelled { background-color: var(--primary-color); } /* Tạm huỷ - Màu đỏ */
      .status-confirmed { background-color: var(--secondary-color); } /* Đã xác nhận - Màu cam */
      .status-new { background-color: #1ac6ff; } /* Mới - Màu xanh nhạt */
      .status-be-cancelled { background-color: var(--primary-color); } /* Đã bị huỷ - Màu đỏ */

      /* Các cột cần căn giữa */
      .status-column, .payment-column, .amount-column, 
      .shipping-column, .delivery-time-column {
          text-align: center;
      }

      /* Đảm bảo status badge không bị tràn */
      td.status-column span {
          width: 100%;
          box-sizing: border-box;
      }

      /* Điều chỉnh style cho các cột có nội dung dài */
      .customer-column, .address-column {
          white-space: normal;
          word-break: break-word;
          line-height: 1.4;
      }

      /* Đảm bảo tất cả các ô đều có padding đồng nhất */
      th, td {
          padding: 8px 10px;
          text-align: left;
          border: 1px solid #e1e5eb;
          font-size: 14px;
          line-height: 1.5;
          vertical-align: middle;
      }

      /* Responsive table */
      @media screen and (max-width: 1600px) {
        table {
          display: block;
          overflow-x: auto;
          white-space: nowrap;
        }
        
        th, td {
          min-width: unset;
        }

        /* Giữ nguyên độ rộng cột khi scroll */
        .private-code-column, .address-column {
          min-width: 120px;
          max-width: 120px;
        }
      }

      /* Thêm style cho loading overlay */
      .loading-overlay {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(255, 255, 255, 0.9);
          z-index: 9999;
          justify-content: center;
          align-items: center;
          flex-direction: column;
      }

      .loading-spinner {
          width: 50px;
          height: 50px;
          border: 5px solid #f3f3f3;
          border-top: 5px solid #275284;
          border-radius: 50%;
          animation: spin 1s linear infinite;
      }

      .loading-text {
          margin-top: 15px;
          color: #275284;
          font-weight: 500;
      }

      /* Style cho notification */
      .notification {
          position: fixed;
          top: 20px;
          right: 20px;
          padding: 15px 25px;
          border-radius: 8px;
          color: white;
          font-weight: 500;
          opacity: 0;
          transform: translateY(-20px);
          transition: all 0.5s ease;
          z-index: 9999;
          animation: fadeInOut 3s ease forwards;
      }

      @keyframes fadeInOut {
          0% {
              opacity: 0;
              transform: translateY(-20px);
          }
          15% {
              opacity: 1;
              transform: translateY(0);
          }
          85% {
              opacity: 1;
              transform: translateY(0);
          }
          100% {
              opacity: 0;
              transform: translateY(-20px);
          }
      }

      .notification.success {
          background-color: #4CAF50;
      }

      .notification.error {
          background-color: #f44336;
      }

      .notification.visible {
          opacity: 1;
          transform: translateY(0);
      }

      @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
      }

      /* Responsive design cho các thiết bị */
      @media screen and (max-width: 1600px) {
          .container {
              width: 98%;
              margin: 70px auto 0;
          }
      }

      @media screen and (max-width: 1200px) {
          table {
              display: block;
              overflow-x: auto;
              white-space: nowrap;
          }
          
          .container {
              padding: 10px;
          }
      }

      /* Tablet & Mobile shared styles */
      @media screen and (max-width: 1024px) {
        .header {
          padding: 10px 15px;
          height: auto;
          display: flex;
          flex-direction: row;
          align-items: center;
          justify-content: space-between;
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          background: white;
          z-index: 1000;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .logo {
          height: 35px;
          margin: 0;
        }

        .nav {
          display: flex;
          gap: 20px;
          margin: 0;
        }

        .container {
          margin-top: 70px;
          padding: 15px;
          width: 100%;
        }

        .search-container {
          padding: 15px;
          gap: 15px;
        }

        .search-box {
          display: flex;
          flex-direction: row;
          gap: 10px;
          width: 100%;
        }

        input[type="text"] {
          flex: 1;
          min-height: 40px;
        }

        #searchBtn {
          min-width: 100px;
          height: 40px;
        }

        .viber-button {
          width: 100%;
          justify-content: center;
          min-height: 40px;
        }

        .filter-export-container {
          flex-direction: column;
          gap: 15px;
        }

        #filterContainer {
          flex-direction: row;
          flex-wrap: wrap;
          gap: 10px;
          width: 100%;
        }

        #columnSelect, 
        #valueSelect {
          flex: 1;
          min-width: 150px;
          height: 40px;
        }

        #applyFilterBtn {
          min-width: 120px;
          height: 40px;
        }

        #exportBtn {
          width: 100%;
          height: 40px;
        }

        /* Table adjustments */
        table {
          display: block;
          overflow-x: auto;
          white-space: nowrap;
          -webkit-overflow-scrolling: touch;
        }

        td, th {
          min-width: 100px;
          padding: 8px;
        }

        table tr td:nth-child(5) { /* Mã đơn hàng */
          min-width: 180px;
        }

        table tr td:nth-child(7) { /* Khách hàng */
          min-width: 200px;
        }

        table tr td:nth-child(8) { /* Địa chỉ */
          min-width: 250px;
        }
      }

      /* Mobile specific styles */
      @media screen and (max-width: 768px) {
        .header {
          padding: 10px;
          height: 50px;
          display: flex;
          align-items: center;
          justify-content: flex-start;
          gap: 15px;
        }

        .logo {
          height: 30px;
        }

        .nav {
          margin-left: 10px;
        }

        .nav-item {
          font-size: 14px;
          padding: 5px 10px;
        }

        .search-container {
          padding: 12px;
          margin-bottom: 15px;
          display: flex;
          flex-direction: row;
          gap: 10px;
          align-items: center;
        }

        .search-box {
          display: flex;
          gap: 8px;
          align-items: center;
        }

        input[type="text"] {
          height: 38px;
          font-size: 14px;
          padding: 8px 12px;
        }

        #searchBtn {
          height: 38px;
          padding: 0 15px;
          font-size: 14px;
          display: flex;
          align-items: center;
          white-space: nowrap;
        }

        .viber-button {
          height: 38px;
          padding: 0 15px;
          font-size: 14px;
          display: flex;
          align-items: center;
          white-space: nowrap;
          gap: 5px;
        }

        .viber-button i {
          font-size: 14px;
        }
      }

      /* Pagination styles */
      .pagination {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;
        margin-top: 20px;
        flex-wrap: wrap;
      }

      .pagination button {
        padding: 8px 16px;
        border: 1px solid #ddd;
        background-color: white;
        color: var(--primary-color);
        cursor: pointer;
        border-radius: 4px;
        font-size: 14px;
        min-width: 40px;
        transition: all 0.3s ease;
      }

      .pagination button:hover {
        background-color: #f5f5f5;
        border-color: var(--primary-color);
      }

      .pagination button.active {
        background-color: var(--primary-color);
        color: white;
        border-color: var(--primary-color);
      }

      .pagination button:disabled {
        background-color: #f5f5f5;
        color: #999;
        cursor: not-allowed;
        border-color: #ddd;
      }

      /* Style cho nút Tiếp */
      .pagination button.next {
        background-color: white;
        color: var(--primary-color);
      }

      .pagination button.next:hover {
        background-color: #f5f5f5;
        border-color: var(--primary-color);
      }

      /* Footer styles */
      .footer {
        text-align: center;
        padding: 20px;
        margin-top: 30px;
        border-top: 1px solid #ddd;
        color: #666;
        font-size: 14px;
        font-weight: 300;
      }

      .footer a {
        color: #275284;
        text-decoration: none;
        font-weight: 500;
      }

      .footer a:hover {
        text-decoration: underline;
      }

      /* Thêm/chỉnh sửa CSS cho phần filter */
      #filterContainer {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      /* Style cho select boxes */
      #columnSelect, #valueSelect {
        padding: 8px 12px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
        color: #333;
        background-color: white;
        min-width: 150px;
        transition: all 0.3s ease;
      }

      #columnSelect:hover, #valueSelect:hover {
        border-color: #275284;
      }

      #columnSelect:focus, #valueSelect:focus {
        outline: none;
        border-color: #275284;
        box-shadow: 0 0 0 2px rgba(39, 82, 132, 0.1);
      }

      /* Style cho label */
      #filterContainer label {
        color: #275284;
        font-weight: 500;
        font-size: 14px;
      }

      /* Style cho nút áp dụng lọc */
      #applyFilterBtn {
        padding: 8px 16px;
        background-color: white;
        color: #275284;
        border: 1px solid #275284;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s ease;
      }

      #applyFilterBtn:hover {
        background-color: #275284;
        color: white;
      }

      /* Container cho phần filter và export */
      .filter-export-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      /* Style cho nút xuất dữ liệu */
      #exportBtn {
        padding: 8px 16px;
        background-color: #28a745;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s ease;
        white-space: nowrap;
      }

      #exportBtn:hover {
        background-color: #218838;
      }

      /* Chỉnh sửa style cho nút tra cứu */
      #searchBtn {
        padding: 8px 16px;
        background-color: #275284;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s ease;
        white-space: nowrap;
        display: flex;
        align-items: center;
        gap: 8px;
        min-width: fit-content;
      }

      #searchBtn i {
        font-size: 14px;
      }

      #searchBtn:hover {
        background-color: #1a3a5f;
      }

      /* Style cho nút copy */
      .tooltip-class {
        position: relative;
        display: flex;
        align-items: center;
        width: 100%;
        height: 100%;
        min-height: 40px;
      }

      .tooltip-class span {
        flex: 1;
        text-align: left;
        padding-left: 10px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .copy-btn {
        visibility: hidden;
        opacity: 0;
        background: transparent;
        padding: 5px;
        font-size: 14px;
        color: #275284;
        border: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: opacity 0.3s ease;
        border-radius: 4px;
        margin-right: 5px;
        min-width: 32px;
      }

      .tooltip-class:hover .copy-btn {
        visibility: visible;
        opacity: 1;
        background-color: #f8f9fa;
      }

      .copy-btn:hover {
        color: var(--primary-color);
        background-color: #e9ecef;
      }

      /* Thông báo copy thành công */
      .copy-success {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #4CAF50;
        color: white;
        padding: 8px 16px;
        border-radius: 4px;
        font-size: 14px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        z-index: 9999;
        display: none;
      }

      /* Style cho trạng thái đơn hàng */
      .status-finished {
        color: #FFFFFF;
        background-color: #4CAF50;
        border-radius: 25px;
        padding: 5px 9px
      }

      .status-waiting,
      .status-cancelled,
      .status-be-cancelled {
        color: #FFFFFF;
        background-color: #F44336;
        border-radius: 25px;
        padding: 5px 9px
      }

      .status-internal {
        color: #FFFFFF;
        background-color: #9C27B0;
        border-radius: 25px;
        padding: 5px 9px
      }

      .status-delivery {
        color: #FFFFFF;
        background-color: #2196F3;
        border-radius: 25px;
        padding: 5px 9px
      }

      .status-confirmed {
        color: #FFFFFF;
        background-color: #ffc266;
        border-radius: 25px;
        padding: 5px 9px
      }

      .status-new {
        color: #FFFFFF;
        background-color: #1ac6ff;
        border-radius: 25px;
        padding: 5px 9px
      }

      .status-wod {
        color: #FFFFFF;
        background-color: #9126f0;
        border-radius: 25px;
        padding: 5px 9px
      }

      /* Style cho cột trạng thái */
      .status-column {
        width: 130px;
        max-width: 130px;
        text-align: center;
      }

      /* Tablet styles (iPad) */
      @media screen and (min-width: 768px) and (max-width: 1024px) {
        .header {
          padding: 10px 15px;
          height: 60px;
          display: flex;
          align-items: center;
          justify-content: flex-start;
          gap: 20px;
        }

        .logo {
          height: 35px;
        }

        .nav {
          margin-left: 15px;
        }

        .nav-item {
          font-size: 14px;
          padding: 5px 12px;
        }

        .container {
          padding: 15px;
          margin-top: 70px;
        }

        .search-container {
          padding: 15px;
          margin-bottom: 20px;
          display: flex;
          flex-direction: row;
          gap: 15px;
          align-items: center;
        }

        .search-box {
          display: flex;
          gap: 10px;
          align-items: center;
          max-width: none;
        }

        input[type="text"] {
          height: 38px;
          font-size: 14px;
          padding: 8px 12px;
          flex: 1;
        }

        #searchBtn {
          height: 38px;
          padding: 0 15px;
          font-size: 14px;
          min-width: 100px;
          display: flex;
          align-items: center;
          justify-content: center;
          white-space: nowrap;
        }

        .viber-button {
          height: 38px;
          padding: 0 15px;
          font-size: 14px;
          min-width: 100px;
          display: flex;
          align-items: center;
          justify-content: center;
          white-space: nowrap;
          gap: 5px;
        }

        .filter-export-container {
          display: flex;
          flex-direction: row;
          gap: 15px;
          align-items: center;
          margin-bottom: 20px;
        }

        #filterContainer {
          display: flex;
          flex-direction: row;
          gap: 10px;
          align-items: center;
          flex-wrap: wrap;
        }

        #columnSelect, 
        #valueSelect {
          height: 38px;
          min-width: 150px;
          font-size: 14px;
          padding: 0 10px;
        }

        #applyFilterBtn {
          height: 38px;
          padding: 0 15px;
          font-size: 14px;
          min-width: 100px;
        }

        #exportBtn {
          height: 38px;
          padding: 0 15px;
          font-size: 14px;
          min-width: 120px;
        }
      }

      .chat-popup {
          position: fixed;
          bottom: 20px;
          right: 20px;
          z-index: 1000;
          display: flex;
          flex-direction: column;
      }

      .chat-button {
          width: 60px;
          height: 60px;
          border-radius: 50%;
          background-color: #275284;
          color: white;
          display: flex;
          align-items: center;
          justify-content: center;
          cursor: pointer;
          box-shadow: 0 2px 10px rgba(0,0,0,0.2);
          transition: all 0.3s ease;
          border: none;
          font-size: 24px;
      }

      .chat-button:hover {
          transform: scale(1.1);
          background-color: #1a3b5f;
      }

      .chat-frame {
          position: fixed;
          bottom: 90px;
          right: 20px;
          width: 400px;
          height: 600px;
          background: white;
          border-radius: 10px;
          box-shadow: 0 5px 20px rgba(0,0,0,0.2);
          display: none;
          overflow: hidden;
          transition: all 0.3s ease;
      }

      .chat-frame.show {
          display: block;
      }

      .chat-frame.fullscreen {
          width: 100%;
          height: 100%;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          border-radius: 0;
          z-index: 2000;
      }

      .chat-frame iframe {
          width: 100%;
          height: 100%;
          border: none;
      }

      .chat-controls {
          position: absolute;
          top: 10px;
          right: 10px;
          display: flex;
          gap: 10px;
          z-index: 2001;
      }

      .fullscreen-button,
      .close-button {
          width: 30px;
          height: 30px;
          border-radius: 50%;
          color: white;
          display: flex;
          align-items: center;
          justify-content: center;
          cursor: pointer;
          border: none;
          font-size: 14px;
          opacity: 0.8;
          transition: all 0.3s ease;
      }

      .fullscreen-button {
          background-color: #275284;
      }

      .close-button {
          background-color: #dc3545;
      }

      .fullscreen-button:hover,
      .close-button:hover {
          opacity: 1;
          transform: scale(1.1);
      }

      @media screen and (max-width: 768px) {
          .chat-frame {
              width: 100%;
              height: 100%;
              bottom: 0;
              right: 0;
              border-radius: 0;
          }
      }

      /* Style cho trang trí Tết */
      .tet-decoration {
        position: fixed;
        top: 10px;
        right: 10px;
        width: 200px;
        height: auto;
        z-index: 9999;
        animation: fadeInDown 1s ease-out, bounce 2s ease infinite 1s;
        filter: drop-shadow(2px 4px 6px rgba(0, 0, 0, 0.2));
      }

      @keyframes bounce {
        0%, 100% {
            transform: translateY(0);
        }
        50% {
            transform: translateY(-15px);
        }
      }

      @keyframes fadeInDown {
        from {
            opacity: 0;
            transform: translate3d(0, -100%, 0);
        }
        to {
            opacity: 1;
            transform: translate3d(0, 0, 0);
        }
      }
    </style>
  </head>
  <body>
    <img src="https://i.postimg.cc/tCPSfT4H/Pngtree-2025-year-of-the-snake-19133441.png" 
         alt="Tết 2024" 
         class="tet-decoration">

    <div class="header">
      <img src="https://i.postimg.cc/KzrDZKw6/logo-final-02.png" alt="Logo" class="logo">
      <nav class="nav">
        <div class="dropdown">
          <a href="#" class="nav-item">Tra cứu</a>
          <div class="dropdown-content">
            <a href="https://ymedgroup.github.io/lpcheck/">Tra cứu đơn Mekong</a>
            <a href="https://ymedgroup.github.io/ymed/">Tra cứu đơn YMED</a>
          </div>
        </div>
        <div class="dropdown">
          <a href="#" class="nav-item">Tồn kho</a>
          <div class="dropdown-content">
		    <a href="#">Tồn kho HN</a>
                    <a href="https://ymedgroup.github.io/tonkhosale/">Tồn kho HCM</a>
		    <a href="https://ymedgroup.github.io/tonkhodaily/">Tồn kho Đại lý</a>
            <a href="#" onclick="checkPassword(); return false;">Tồn kho toàn quốc</a>
          </div>
        </div>
        <div class="dropdown">
          <a href="https://ymedgroup.github.io/chatroom/" class="nav-item">Tán gẫu</a>
        </div>
      </nav>
    </div>

    <div class="container">
    <h1>Tra Cứu Đơn Hàng</h1>
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Đang tải dữ liệu...</div>
    </div>

    <div id="notification" class="notification">
        <span id="notificationMessage"></span>
    </div>
      
    <div class="search-container">
        <div class="search-box">
      <input type="text" id="privateCode" placeholder="Nhập mã đơn hàng, tên khách hàng,... để tra cứu">
          <button id="searchBtn" type="button" onclick="fetchOrders()">
            <i class="fas fa-search"></i>
            Tra Cứu
          </button>
        </div>
        <a href="viber://chat?number=%2B84915665422" target="_self" class="viber-button">
          <i class="fab fa-viber"></i>
          Liên hệ kho qua Viber
        </a>
    </div>

    <div class="filter-export-container">
      <div id="filterContainer">
	  <label for="columnSelect">Bộ lọc:</label>
        <select id="columnSelect">
		<option value="">-- Chọn cột --</option>
		<option value="orders_created">Ngày đơn hàng</option>
		<option value="orders_status">Trạng thái</option>
		<option value="private_code">Đơn đặt hàng</option>
		<option value="mode_of_payment">Thanh toán</option>
	  </select>
        <select id="valueSelect">
		<option value="">-- Chọn giá trị --</option>
	  </select>
        <button id="applyFilterBtn">Áp dụng lọc</button>
      </div>
        <button id="exportBtn" type="button" onclick="exportSelectedOrders()">
            <i class="fas fa-download"></i>
            Xuất Dữ Liệu
        </button>
	</div>

    <table id="ordersTable">
      <thead>
        <tr>
          <th class="checker-column">Checker</th>
          <th>Ngày đơn hàng</th>
          <th>Lịch giao hàng</th>
          <th class="status-column">Trạng thái</th>
          <th>Mã đơn hàng</th>
          <th class="long-text">Đơn đặt hàng</th>
          <th>Khách hàng</th>
          <th>Địa chỉ giao</th>
          <th class="payment">Thanh toán</th>
          <th class="amount">Giá trị đơn</th>
          <th class="shipping-fee">Phí giao</th>
          <th>Thời gian giao</th>
          <th class="hidden">Ghi chú</th>
        </tr>
      </thead>
      <tbody id="ordersBody"></tbody>
    </table>
      <div class="pagination">
        <button onclick="changePage(1)" class="active">1</button>
        <button onclick="changePage(2)">2</button>
        <button onclick="changePage(3)">3</button>
        <button onclick="changePage(4)">4</button>
        <button onclick="changePage(5)">5</button>
        <button onclick="changePage('next')" class="next">Tiếp</button>
      </div>
      <div class="footer">
        <p>© 2024 Tra cứu tồn kho Cloudify</p>
        <p>Được phát triển bởi <a href="">Trần Văn Tiến Anh</a> và Claude (AI)</p>
      </div>
    </div>

    <!-- Add Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script>
      let isFirstLoad = true;
      let cachedOrders = [];
      let filteredOrders = null;
      let currentPage = 1;
      const itemsPerPage = 30;

      function formatDateTime(dateString) {
        const date = new Date(dateString);
        const day = date.getDate().toString().padStart(2, '0');
        const month = (date.getMonth() + 1).toString().padStart(2, '0');
        const year = date.getFullYear();
        const hours = date.getHours().toString().padStart(2, '0');
        const minutes = date.getMinutes().toString().padStart(2, '0');
        return `${day}/${month}/${year} ${hours}:${minutes}`;
      }

      function formatMoney(amount) {
        if (!amount) return '0';
        return amount.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
      }

      function getOrderStatus(status) {
        const statusMap = {
          'finished': '<span class="status-finished">Đã giao</span>',
          'waiting_temp_canceled': '<span class="status-waiting">Tạm huỷ</span>',
          'internal_transport': '<span class="status-internal">Chuyển kho</span>',
          'delivery': '<span class="status-delivery">Đang giao</span>',
          'wod_confirmed': '<span class="status-wod">Nhập kho giao</span>',
          'temp_cancelled': '<span class="status-cancelled">Tạm huỷ</span>',
          'lp_confirmed': '<span class="status-confirmed">Đã xác nhận</span>',
          'new': '<span class="status-new">Mới(Đã đóng gói)</span>',
          'cancelled': '<span class="status-be-cancelled">Đã bị huỷ</span>'
        };
        return statusMap[status] || status;
      }

      function showNotification(message, type) {
        const notification = document.getElementById('notification');
        notification.className = `notification ${type}`;
        notification.innerHTML = `<span id="notificationMessage">${message}</span>`;
        notification.style.display = 'block';
        
        // Kích hoạt lại animation bằng cách xóa và thêm lại element
        notification.style.animation = 'none';
        notification.offsetHeight; // Trigger reflow
        notification.style.animation = 'fadeInOut 3s ease forwards';
      }

      function createPageButton(text, page) {
        const button = document.createElement('button');
        button.textContent = text;
        if (page === currentPage) button.classList.add('active');
        button.onclick = () => changePage(page);
        return button;
      }

      function changePage(page) {
        if (page === 'next') {
          currentPage++;
        } else {
          currentPage = page;
        }
        renderOrders(filteredOrders || cachedOrders);
      }

      async function fetchOrders() {
        try {
            document.getElementById('loadingOverlay').style.display = 'flex';
            
            const privateCode = document.getElementById('privateCode').value;
            let filterString = '';
            if (privateCode) {
                filterString = `(((contains(private_code,'${privateCode}')) or (contains(orders_cancel_reason,'${privateCode}')) or (contains(orders_code,'${privateCode}')) or (contains(orders_temp_cancel_full_reason,'${privateCode}')) or (contains(orders_temp_cancel_reason,'${privateCode}')) or (contains(pod_districts,'${privateCode}')) or (contains(orders_customer_name,'${privateCode}'))))`
            }

            const response = await fetch("https://giaoduocpham.vn/graphql", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": "Bearer BAJ2DY4ZoepiEXmAd,ba8d2b0ba7ec1200732f08892d20c84cf01d12f755c0fcb1733bfaaae5dca25ac46cc7ef862b3923538fc1"
                },
                body: JSON.stringify({
                    query: `{records: orders(skip: 0, top: 9999, filters: "${filterString}") {_id,orders_code,private_code,orders_status,orders_amount,orders_fee_aft_vat,orders_pod_name,orders_customer_name,orders_created,mode_of_payment,time_delivery_reality,orders_delivery_schedule__expand {_id,delivery_schedule_name} orders_temp_cancel_note},count: orders__count}`
                })
            });

            const data = await response.json();
            
            if (data.data.records.length === 0) {
                showNotification('Không tìm thấy đơn hàng', 'error');
            } else {
                const totalOrders = data.data.records.length;
                const tempCancelledOrders = data.data.records.filter(order => 
                    order.orders_status === 'waiting_temp_canceled' || 
                    order.orders_status === 'temp_cancelled'
                ).length;
                
                let message = `Đã tìm thấy ${totalOrders} đơn hàng`;
                if (tempCancelledOrders > 0) {
                    message += `, trong đó có ${tempCancelledOrders} đơn tạm huỷ`;
                }
                showNotification(message, 'success');
            }

            cachedOrders = data.data.records;
            // Mặc định sắp xếp theo thời gian mới nhất
            cachedOrders.sort((a, b) => new Date(b.orders_created) - new Date(a.orders_created));
            
            filteredOrders = null;
            currentPage = 1;
            renderOrders(cachedOrders);
            isFirstLoad = false;

        } catch (error) {
            showNotification('Đã có lỗi xảy ra khi tải dữ liệu', 'error');
            console.error('Error:', error);
        } finally {
            document.getElementById('loadingOverlay').style.display = 'none';
        }
      }

      function renderOrders(orders) {
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        
        const rows = orders
            .slice(startIndex, endIndex)
            .map((order) => {
                return `<tr>
                    <td class="text-center">
                        <input type="checkbox" class="order-checkbox" value="${order.orders_code}">
                    </td>
                    <td class="text-center">${formatDateTime(order.orders_created)}</td>
                    <td class="text-center">${order.orders_delivery_schedule__expand?.delivery_schedule_name || ''}</td>
                    <td class="text-center">${getOrderStatus(order.orders_status)}</td>
                    <td class="order-code-column">
                        <div class="tooltip-class">
                            <span>${order.orders_code}</span>
                            <button class="copy-btn" onclick="copyToClipboard('${order.orders_code}')">
                                <i class="far fa-copy"></i>
                            </button>
                        </div>
                    </td>
                    <td title="${order.private_code || ''}">${order.private_code || ''}</td>
                    <td>${order.orders_customer_name || ''}</td>
                    <td title="${order.orders_pod_name || ''}">${order.orders_pod_name || ''}</td>
                    <td class="text-center">${order.mode_of_payment === 'cash' ? 'COD' : 'Không thu hộ'}</td>
                    <td class="text-right">${formatMoney(order.orders_amount)}</td>
                    <td class="text-right">${formatMoney(order.orders_fee_aft_vat)}</td>
                    <td class="text-center">${order.time_delivery_reality ? formatDateTime(order.time_delivery_reality) : ''}</td>
                    <td>${order.orders_temp_cancel_note || ''}</td>
                </tr>`;
            })
            .join('');

        document.getElementById('ordersBody').innerHTML = rows;
        
        // Cập nhật phân trang
        const totalPages = Math.ceil(orders.length / itemsPerPage);
        renderPagination(orders.length, totalPages);
      }

      function renderPagination(totalItems, totalPages) {
        const pagination = document.querySelector('.pagination');
        pagination.innerHTML = '';

		  if (totalPages <= 1) return;

        // Nút Trước
		  if (currentPage > 1) {
            pagination.appendChild(createPageButton('Trước', currentPage - 1));
        }
        
        // Các nút số trang
        let startPage = Math.max(1, currentPage - 2);
        let endPage = Math.min(totalPages, currentPage + 2);
        
        // Đảm bảo luôn hiển thị 5 nút số trang nếu có thể
        if (endPage - startPage < 4) {
            if (startPage === 1) {
                endPage = Math.min(5, totalPages);
            } else {
                startPage = Math.max(1, totalPages - 4);
            }
        }

        // Hiển thị các nút số trang
		  for (let i = startPage; i <= endPage; i++) {
            const button = createPageButton(i, i);
            if (i === currentPage) {
                button.classList.add('active');
            }
            pagination.appendChild(button);
        }
        
        // Nút Tiếp
		  if (currentPage < totalPages) {
            pagination.appendChild(createPageButton('Tiếp', currentPage + 1));
        }
    }

    function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
            // Hiển thị thông báo
            const notification = document.createElement('div');
            notification.className = 'copy-success';
            notification.textContent = 'Đã sao chép!';
            document.body.appendChild(notification);
            
            // Hiển thị notification
            notification.style.display = 'block';
            
            // Ẩn sau 2 giây
            setTimeout(() => {
                notification.style.display = 'none';
                notification.remove();
            }, 2000);
        });
    }

    function formatDisplayedValue(column, value) {
      if (column === 'orders_created') {
        const date = new Date(value);
        return `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()}`;
      } else if (column === 'orders_status') {
        const statusMap = {
          finished: 'Đã giao',
          waiting_temp_canceled: 'Tạm huỷ',
          internal_transport: 'Chuyển kho',
          delivery: 'Đang giao',
          wod_confirmed: 'Nhập kho giao',
          temp_cancelled: 'Tạm huỷ',
          lp_confirmed: 'Đã xác nhận',
          new: 'Mới (Đã đóng gói)',
          cancelled: 'Đã bị huỷ'
        };
        return statusMap[value] || value;
      } else if (column === 'mode_of_payment') {
        const paymentMap = {
          cash: 'COD',
          bank: 'Không thu hộ'
        };
        return paymentMap[value] || value;
      }
      return value;
    }

    function updateFilterOptions() {
      const column = document.getElementById('columnSelect').value;
      const valueSelect = document.getElementById('valueSelect');
      valueSelect.innerHTML = '<option value="">-- Chọn giá trị --</option>';

      if (!column) return;

      const uniqueValues = [...new Set(cachedOrders.map(order => formatDisplayedValue(column, order[column])))];
      uniqueValues.forEach(displayedValue => {
        const rawValue = cachedOrders.find(order => formatDisplayedValue(column, order[column]) === displayedValue)[column];
        const option = document.createElement('option');
        option.value = rawValue;
        option.textContent = displayedValue;
        valueSelect.appendChild(option);
      });
    }

    function applyFilter() {
      const column = document.getElementById('columnSelect').value;
      const rawValue = document.getElementById('valueSelect').value;

      if (!column || !rawValue) {
        alert("Vui lòng chọn cả cột và giá trị để lọc.");
        return;
      }

      currentPage = 1;
      
      filteredOrders = cachedOrders.filter(order => {
        if (column === 'orders_created') {
          const orderDate = new Date(order[column]);
          const selectedDate = new Date(rawValue);
          return orderDate.toDateString() === selectedDate.toDateString();
        } else {
          return order[column] === rawValue;
        }
      });

      renderOrders(filteredOrders);
    }

    function clearFilter() {
      document.getElementById('columnSelect').value = '';
      document.getElementById('valueSelect').innerHTML = '<option value="">-- Chọn giá trị --</option>';
      filteredOrders = null;
      currentPage = 1;
      renderOrders(cachedOrders);
    }

    document.getElementById('filterContainer').innerHTML += `
      <button onclick="clearFilter()" class="filter-button">
        <i class="fas fa-times"></i>
        Xóa bộ lọc
      </button>
    `;

    document.getElementById('columnSelect').addEventListener('change', updateFilterOptions);
    document.getElementById('applyFilterBtn').addEventListener('click', applyFilter);

		function exportSelectedOrders() {
		  const checkboxes = document.querySelectorAll('.order-checkbox');
		  const selectedOrders = [];

		  checkboxes.forEach((checkbox) => {
			if (checkbox.checked) {
			  const row = checkbox.closest('tr');
			  const cells = Array.from(row.querySelectorAll('td')).slice(1);
			  const orderData = cells.map(cell => cell.innerText);
			  selectedOrders.push(orderData);
			}
		  });

		  // Nếu không có đơn hàng nào được chọn, chuyển đổi dữ liệu thô thành dữ liệu tinh chỉnh
		  const exportData = selectedOrders.length > 0 ? selectedOrders : cachedOrders.map(order => [
			// Chuyển đổi ngày thành định dạng dễ đọc
			new Date(order.orders_created).toLocaleDateString('vi-VN'),

			// Lịch giao hàng
			order.orders_delivery_schedule__expand.delivery_schedule_name || '',

			// Chuyển đổi mã trạng thái thành tên trạng thái dễ hiểu
			{
			  finished: 'Đã giao',
			  waiting_temp_canceled: 'Tạm huỷ',
			  internal_transport: 'Chuyển kho',
			  delivery: 'Đang giao',
			  wod_confirmed: 'Nhập kho giao',
			  temp_cancelled: 'Tạm huỷ',
			  lp_confirmed: 'Đã xác nhận',
			  new: 'Mới (Đã đóng gói)',
			  cancelled: 'Đã bị huỷ'
			}[order.orders_status] || order.orders_status,

			// Mã đơn hàng
			order.orders_code,

			// Đơn đặt hàng
			order.private_code,

			// Tên khách hàng
			order.orders_customer_name,

			// Địa chỉ giao hàng
			order.orders_pod_name,

			// Phương thức thanh toán (COD hoặc Không thu hộ)
			order.mode_of_payment === 'cash' ? 'COD' : 'Không thu hộ',

			// Giá trị đơn hàng, định dạng tiền tệ
			order.orders_amount ? order.orders_amount.toLocaleString('vi-VN') : 0,

			// Phí giao hàng, định dạng tiền tệ
			order.orders_fee_aft_vat ? order.orders_fee_aft_vat.toLocaleString('vi-VN') : 0,

			// Thời gian giao thực tế, định dạng ngày giờ
			order.time_delivery_reality ? new Date(order.time_delivery_reality).toLocaleString('vi-VN') : '',

			// Ghi chú, nếu có
			order.orders_temp_cancel_note || ''
		  ]);

		  // Tạo workbook và worksheet
		  const wb = XLSX.utils.book_new();
		  const wsData = [
			["Ngày đơn hàng", "Lịch giao hàng", "Trạng thái", "Mã đơn hàng", "Đơn đặt hàng", "Khách hàng", "Địa chỉ giao", "Thanh toán", "Giá trị đơn", "Phí giao hàng", "Thời gian giao", "Ghi chú"], 
			...exportData
		  ];
		  const ws = XLSX.utils.aoa_to_sheet(wsData);

		  // Tùy chỉnh cột tự động, font chữ, in đậm header và bo viền
		  wsData.forEach((row, rowIndex) => {
			row.forEach((_, colIndex) => {
			  const cellAddress = XLSX.utils.encode_cell({ r: rowIndex, c: colIndex });
			  if (!ws[cellAddress]) return;

			  ws[cellAddress].s = {
				font: {
				  name: "Times New Roman",
				  sz: 12,
				  bold: rowIndex === 0
				},
				alignment: {
				  vertical: "center",
				  horizontal: "center",
				  wrapText: true
				},
				border: {
				  top: { style: "thin" },
				  bottom: { style: "thin" },
				  left: { style: "thin" },
				  right: { style: "thin" }
				}
			  };
			});
		  });

		  // Tự động điều chỉnh độ rộng cột
		  ws['!cols'] = wsData[0].map(() => ({ wch: 20 }));

		  XLSX.utils.book_append_sheet(wb, ws, "Orders");

		  const today = new Date();
		  const fileName = `LP_Data_${today.getDate()}_${today.getMonth() + 1}.xlsx`;
		  XLSX.writeFile(wb, fileName);
		  
		  showNotification("Đã xuất thành công", "success");
		}

    window.onload = fetchOrders;
    document.getElementById('searchBtn').addEventListener('click', () => {
      cachedOrders = [];
      fetchOrders()
    });

    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('chatButton').addEventListener('click', function() {
            const chatFrame = document.getElementById('chatFrame');
            chatFrame.classList.toggle('show');
        });

        document.getElementById('fullscreenButton').addEventListener('click', function() {
            const chatFrame = document.getElementById('chatFrame');
            chatFrame.classList.toggle('fullscreen');
            const icon = this.querySelector('i');
            if (chatFrame.classList.contains('fullscreen')) {
                icon.classList.remove('fa-expand');
                icon.classList.add('fa-compress');
            } else {
                icon.classList.remove('fa-compress');
                icon.classList.add('fa-expand');
            }
        });

        document.getElementById('closeButton').addEventListener('click', function() {
            const chatFrame = document.getElementById('chatFrame');
            chatFrame.classList.remove('show');
        });

        document.addEventListener('click', function(event) {
            const chatFrame = document.getElementById('chatFrame');
            const chatButton = document.getElementById('chatButton');
            const chatControls = document.querySelector('.chat-controls');
            
            if (!chatFrame.contains(event.target) && 
                !chatButton.contains(event.target) && 
                !chatControls.contains(event.target) &&
                chatFrame.classList.contains('show')) {
                chatFrame.classList.remove('show');
            }
        });
    });
	</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
    <div id="copyNotification" class="copy-success">Đã sao chép!</div>
    <div class="chat-popup">
        <div class="chat-frame" id="chatFrame">
            <div class="chat-controls">
                <button class="fullscreen-button" id="fullscreenButton">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="close-button" id="closeButton">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <iframe src="https://ymedgroup.github.io/chatroom/"></iframe>
        </div>
        <button class="chat-button" id="chatButton">
            <i class="fas fa-comments"></i>
        </button>
    </div>
  </body>
</html>
